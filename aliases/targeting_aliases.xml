<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE MudletPackage>
<MudletPackage version="1.001">
	<AliasPackage>
		<AliasGroup isActive="yes" isFolder="yes">
			<name>Targeting</name>
			<script></script>
			<command></command>
			<packageName></packageName>
			<regex></regex>
			<Alias isActive="yes" isFolder="no">
				<name>Add target</name>
				<script>--syntax: t1 xxx, t2 xxx, t3 xxx, t4 xxx, etc.

local colors =
  {
    dark = "ansi_red",
    light = "ansi_cyan",
    trolloc = "ansi_red",
    myrddraal = "ansi_red",
    dreadlord = "ansi_red",
    grayman = "ansi_red",
    draghkar = "ansi_red",
    human = "ansi_cyan",
    seanchan = "ansi_magenta",
    ogier = "ansi_green",
    aiel = "ansi_white"
  }

targeting = targeting or {}

local index = tonumber(matches[2])
local tgt = matches[3]
local color = colors[tgt] or "reset"

targeting[index] = tgt
cecho("Target "..index.." set to: &lt;"..color.."&gt;"..tgt.."\n")</script>
				<command></command>
				<packageName></packageName>
				<regex>^t(\d+) (\S+)$</regex>
			</Alias>
			<Alias isActive="yes" isFolder="no">
				<name>Target specific</name>
				<script>--syntax: t1, t2, t3, t4, etc.

local colors =
  {
    dark = "ansi_red",
    light = "ansi_cyan",
    trolloc = "ansi_red",
    myrddraal = "ansi_red",
    dreadlord = "ansi_red",
    grayman = "ansi_red",
    draghkar = "ansi_red",
    human = "ansi_cyan",
    seanchan = "ansi_magenta",
    ogier = "ansi_green",
    aiel = "ansi_white"
  }
  
targeting = targeting or {}

local index = tonumber(matches[2])

if targeting[index] then
  local tgt = targeting[index]
  local color = colors[tgt] or "reset"
  
  targeting.currtgt = tgt
  cecho("Current target set to: &lt;"..color.."&gt;" .. tgt .. "\n")
  
  if color ~= "reset" then
    status_bar["target"]:echo(tgt:upper(), color, "c")
  else
    status_bar["target"]:echo(tgt:upper(), "white", "c")
  end
  
else
  cecho("&lt;red&gt;Target "..index.." not set!\n")
end</script>
				<command></command>
				<packageName></packageName>
				<regex>^t(\d+)$</regex>
			</Alias>
			<Alias isActive="yes" isFolder="no">
				<name>Show targets</name>
				<script>--syntax: targets

local colors =
  {
    dark = "ansi_red",
    light = "ansi_cyan",
    trolloc = "ansi_red",
    myrddraal = "ansi_red",
    dreadlord = "ansi_red",
    grayman = "ansi_red",
    draghkar = "ansi_red",
    human = "ansi_cyan",
    seanchan = "ansi_magenta",
    ogier = "ansi_green",
    aiel = "ansi_white"
  }
  
targeting = targeting or {}

if targeting.currtgt then
  local color = colors[targeting.currtgt] or "reset"
  cecho("Your current target is: &lt;"..color.."&gt;"..targeting.currtgt.."\n")
end
for k,v in ipairs(targeting) do
  if type(k)=="number" then
    local color = colors[v] or "reset"
    cecho("Target "..k.." = &lt;"..color.."&gt;"..v.."\n")
  end
end</script>
				<command></command>
				<packageName></packageName>
				<regex>^show targets$</regex>
			</Alias>
			<Alias isActive="yes" isFolder="no">
				<name>Clear Targets</name>
				<script>--syntax: clear targets

for k,v in ipairs(targeting) do
  if type(k)=="number" then
    targeting[k] = nil
  end
end
targeting.currtgt = nil
cecho("Targets cleared.\n")
status_bar["target"]:echo("Target", "white", "c")</script>
				<command></command>
				<packageName></packageName>
				<regex>^clear targets$</regex>
			</Alias>
			<Alias isActive="yes" isFolder="no">
				<name>Set current target</name>
				<script>--syntax: tgt xxx

local colors =
  {
    dark = "ansi_red",
    light = "ansi_cyan",
    trolloc = "ansi_red",
    myrddraal = "ansi_red",
    dreadlord = "ansi_red",
    grayman = "ansi_red",
    draghkar = "ansi_red",
    human = "ansi_cyan",
    seanchan = "ansi_magenta",
    ogier = "ansi_green",
    aiel = "ansi_white"
  }
  
targeting = targeting or {}

local tgt = matches[2]
local color = colors[tgt] or "reset"
  
targeting.currtgt = tgt
cecho("Current target set to: &lt;"..color.."&gt;" .. tgt .. "\n")

if color ~= "reset" then
  status_bar["target"]:echo(tgt:upper(), color, "c")
else
  status_bar["target"]:echo(tgt:upper(), "white", "c")
end</script>
				<command></command>
				<packageName></packageName>
				<regex>^tgt (\S+)$</regex>
			</Alias>
			<Alias isActive="yes" isFolder="no">
				<name>Show current target</name>
				<script>--syntax: tgt

local colors =
  {
    dark = "ansi_red",
    light = "ansi_cyan",
    trolloc = "ansi_red",
    myrddraal = "ansi_red",
    dreadlord = "ansi_red",
    grayman = "ansi_red",
    draghkar = "ansi_red",
    human = "ansi_cyan",
    seanchan = "ansi_magenta",
    ogier = "ansi_green",
    aiel = "ansi_white"
  }
  
targeting = targeting or {}

if targeting.currtgt then
  local tgt = targeting.currtgt
  local color = colors[tgt] or "reset"
  
  cecho("Current target set to: &lt;"..color.."&gt;" .. tgt .. "\n")
else
  cecho("&lt;red&gt;Current target not set!\n")
end</script>
				<command></command>
				<packageName></packageName>
				<regex>^tgt$</regex>
			</Alias>
			<Alias isActive="yes" isFolder="no">
				<name>Switch PK Modes</name>
				<script>--syntax: pkmode

targeting=targeting or {}

if targeting.bashing then
  targeting.bashing=false
  targeting.charging=true
  targeting.stabbing=false
  targeting.weaving=false
  cecho("PK method set to: charging\n")
elseif targeting.charging then
  targeting.bashing=false
  targeting.charging=false
  targeting.stabbing=true
  targeting.weaving=false
  cecho("PK method set to: backstabbing\n")
elseif targeting.stabbing then
  targeting.bashing=false
  targeting.charging=false
  targeting.stabbing=false
  targeting.weaving=true
  cecho("PK method set to: weaving\n")
elseif targeting.weaving then
  targeting.bashing=false
  targeting.charging=false
  targeting.stabbing=false
  targeting.weaving=false
  cecho("PK method set to: none\n")
else
  targeting.bashing=true
  targeting.charging=false
  targeting.stabbing=false
  targeting.weaving=false
  cecho("PK method set to: bashing\n")
end

if targeting.charging then
  status_bar.tab_settings["charge_pulses"].display = true
  status_bar:show_status_bar(true)
else
  status_bar.tab_settings["charge_pulses"].display = false
  status_bar:show_status_bar(true)
end</script>
				<command></command>
				<packageName></packageName>
				<regex>^pkmode$</regex>
			</Alias>
			<Alias isActive="yes" isFolder="no">
				<name>Attack Target</name>
				<script>--syntax: p

targeting=targeting or {}

local target=targeting.currtgt

if target then
  send("k "..target)
else
  cecho("&lt;red&gt;Current target not set!\n")
end</script>
				<command></command>
				<packageName></packageName>
				<regex>^p$</regex>
			</Alias>
			<Alias isActive="yes" isFolder="no">
				<name>Attack h.Target</name>
				<script>--syntax: o

targeting=targeting or {}

local target=targeting.currtgt

if target then
  send("k h."..target)
else
  cecho("&lt;red&gt;Current target not set!\n")
end</script>
				<command></command>
				<packageName></packageName>
				<regex>^o$</regex>
			</Alias>
			<Alias isActive="yes" isFolder="no">
				<name>Special on target</name>
				<script>--syntax: q

targeting = targeting or {}
weaving = weaving or {}

local target = targeting.currtgt

local bash = targeting.bashing
local charge = targeting.charging
local stab = targeting.stabbing
local weave = targeting.weaving

if target then
  if bash then
    send("bash h." .. target)
  elseif charge then
    send("charge h." .. target)
  elseif stab then
    send("backstab h." .. target)
  elseif weave then
    if weaving.longweave then
      send("channel '"..weaving.longweave.."' "..target)
    else
      send("channel 'ice spikes' "..target)
    end
  else
    cecho("&lt;red&gt;No pk method set\n")
  end
else
  cecho("&lt;red&gt;Current target not set!\n")
end</script>
				<command></command>
				<packageName></packageName>
				<regex>^q$</regex>
			</Alias>
			<Alias isActive="yes" isFolder="no">
				<name>Delete Target</name>
				<script>--syntax: deltgt

targeting=targeting or {}

targeting.currtgt=nil
cecho("&lt;red&gt;Current target deleted!\n")
status_bar["target"]:echo("Target", "white", "c")</script>
				<command></command>
				<packageName></packageName>
				<regex>^deltgt$</regex>
			</Alias>
			<Alias isActive="yes" isFolder="no">
				<name>Diagnose h.target</name>
				<script>--syntax: a

targeting=targeting or {}

local target=targeting.currtgt

if target then
  send("diagnose h."..target)
else
  cecho("&lt;red&gt;Current target not set!\n")
end</script>
				<command></command>
				<packageName></packageName>
				<regex>^a$</regex>
			</Alias>
		</AliasGroup>
	</AliasPackage>
</MudletPackage>
